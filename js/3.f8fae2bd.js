(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[3],{1543:function(t,e,n){"use strict";var o=n("2591"),a={apiKey:"AIzaSyC3mSqN_lKIPC7ml2LH5iaQj7c85lRu_50",authDomain:"templit-697dc.firebaseapp.com",databaseURL:"https://templit-697dc.firebaseio.com",projectId:"templit-697dc",storageBucket:"templit-697dc.appspot.com",messagingSenderId:"673698949280",appId:"1:673698949280:web:6da4c034a879d4bdfa01c5",measurementId:"G-0P33MV38MC"};e["a"]=o["a"].apps.length?o["a"].app():o["a"].initializeApp(a)},2960:function(t,e,n){},"3ade":function(t,e,n){},"4d4e":function(t,e,n){},"6a0e":function(t,e,n){"use strict";n("b1af")},"8fb8":function(t,e,n){"use strict";n("4d4e")},ad0c:function(t,e,n){"use strict";n("3ade")},b1af:function(t,e,n){},cabd:function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-layout",{staticClass:"outer-layout",attrs:{view:"lHh Lpr lFf"}},[n("q-header",{staticClass:"bg-white header",attrs:{elevated:""}},[n("q-toolbar",{staticClass:"text-black q-py-sm"},[n("q-btn",{attrs:{flat:"",color:"white","text-color":"primary",icon:"home",round:"",to:"/"}}),n("q-toolbar-title",{staticClass:"text-weight-bold"},[t._v("\n        "+t._s(t.documentName)+"\n      ")]),n("AvatarRow"),n("q-btn",{attrs:{flat:"",color:"white","text-color":"primary",icon:"download",round:""}},[n("q-menu",{attrs:{anchor:"bottom middle",self:"top middle"}},[n("q-list",{staticStyle:{"min-width":"120px"},attrs:{dense:""}},[n("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:t.savePdf}},[n("q-item-section",[t._v("Save PDF")])],1),n("q-separator"),n("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:t.saveMarkdown}},[n("q-item-section",[t._v("Save Markdown")])],1),n("q-separator")],1)],1)],1),n("q-btn",{attrs:{flat:"",color:"white","text-color":"primary",icon:"save",round:""},on:{click:t.saveLocally}}),n("q-btn",{attrs:{flat:"",color:"white","text-color":"primary",icon:"cached",round:""},on:{click:t.restoreFromLocal}})],1)],1),n("q-page-container",{staticClass:"outer-page-container"},[n("q-page",{staticClass:"outer-page"},[n("div",{staticClass:"doc-outer"},[n("div",{staticClass:"doc-editor"},[n("DocumentEditor",{ref:"docEditor",attrs:{documentId:t.docId},on:{"contents-loaded":function(e){t.loading=!1},input:t.updatePreview,update:t.updatePreview,save:t.saveLocally}})],1),n("div",{staticClass:"doc-preview"},[n("DocumentPreview",{attrs:{content:t.contents}})],1)])]),n("q-inner-loading",{staticStyle:{"z-index":"10"},attrs:{showing:t.loading}},[n("q-spinner",{attrs:{size:"50px",color:"primary",thickness:10}}),n("div",{staticClass:"text-center text-h6 q-mt-md"},[t._v("\n        Fetching document...\n      ")])],1)],1)],1)},a=[],i=(n("ac1f"),n("1276"),n("5a0c"),n("a002")),r=n.n(i),s=n("21a6"),c=n.n(s),l=n("1543"),d=n("cc8f"),u=n("f430"),m=n("ecf6"),f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("AceEditor",{ref:"aceEditor",attrs:{name:"editor",width:"100%",height:"100%",lang:"markdown",theme:"dracula",options:t.editorOptions,commands:t.commands},on:{init:t.editorInit,input:t.handleInput},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})},p=[],h=(n("99af"),n("fb6a"),n("d3b7"),n("e6cf"),n("96cf"),n("c973")),v=n.n(h),g=n("c17d"),w=n.n(g),b={name:"DocumentEditor",mixins:[u["a"]],components:{AceEditor:w.a},props:{documentId:{type:String,required:!0}},data:function(){return{content:"",editorOptions:{selectionStyle:"line",highlightActiveLine:!0,highlightSelectedWord:!0,readOnly:!1,cursorStyle:"ace",mergeUndoDeltas:!0,behavioursEnabled:!0,wrapBehavioursEnabled:!0,autoScrollEditorIntoView:void 0,animatedScroll:!1,displayIndentGuides:!0,showInvisibles:!1,showPrintMargin:!1,printMarginColumn:80,printMargin:void 0,showGutter:!0,fadeFoldWidgets:!1,showFoldWidgets:!0,showLineNumbers:!0,highlightGutterLine:!0,hScrollBarAlwaysVisible:!1,vScrollBarAlwaysVisible:!1,fontSize:17,fontFamily:void 0,maxLines:void 0,minLines:void 0,scrollPastEnd:0,fixedWidthGutter:!1,scrollSpeed:2,dragDelay:0,dragEnabled:!0,focusTimout:0,tooltipFollowsMouse:!0,firstLineNumber:1,overwrite:!1,newLineMode:"auto",useWorker:!0,useSoftTabs:!0,tabSize:4,wrap:!0,indentedSoftWrap:!0,foldStyle:"markbegin"},commands:[{name:"save",bindKey:{win:"Ctrl-s",mac:"Command-s"},exec:this.saveData,readOnly:!1}]}},computed:{canEdit:function(){return!(this.readOnly||this.$q.platform.is.mobile||this.isOffline)}},methods:{saveData:function(){this.$emit("save")},handleInput:function(t){this.$emit("input",t)},editorInit:function(){n("2099"),n("be9d"),n("c1a9"),n("d067"),n("e1a9"),n("0950")},initializeConnection:function(){var t=this,e=t.$refs.aceEditor.editor,n=t.uid,o=t.timestamp,a=l["a"].database(),i=this.documentId,r=a.ref("documents"),s=r.child(i),c=s.child("queue"),d=!1,u=1/30,m=o-60*u*60*1e3,f=c.orderByChild("timestamp").endAt(m).limitToLast(1);f.on("child_added",(function(t){t.ref.remove()})),s.child("content").once("value",(function(a){t.$emit("contents-loaded"),e.on("change",function(){var o=v()(regeneratorRuntime.mark((function o(a){var i;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(t.$emit("update",e.getValue()),!d){o.next=3;break}return o.abrupt("return");case 3:if(o.t0="remove"===a.action&&""===e.getValue()&&!(0===a.end.row&&1===a.end.column),!o.t0){o.next=8;break}return o.next=7,t.confirmDeletion();case 7:o.t0=!o.sent;case 8:if(!o.t0){o.next=11;break}return window.location.reload(!0),o.abrupt("return");case 11:t.canEdit&&(s.update({content:e.getValue()}),i=Date.now(),c.child("".concat(i,":").concat(String(Math.random()).slice(2))).set({changes:a,by:n,timestamp:i}).catch((function(t){console.error(t)})));case 12:case"end":return o.stop()}}),o)})));return function(t){return o.apply(this,arguments)}}()),c.on("child_added",(function(t){var a=t.key.split(":")[0];if(!(o>a)){var i=t.val();i.by!==n&&(d=!0,e.getSession().getDocument().applyDeltas([i.changes]),d=!1)}})),d=!0,e.setValue(a.val()||"",-1),e.focus(),d=!1}))},confirmDeletion:function(){var t=this;return new Promise((function(e){t.$q.dialog({title:"Confirm",message:"Are you sure you want to delete the contents of this document?",cancel:!0,persistent:!0}).onOk((function(){return e(!0)})).onCancel((function(){return e(!1)}))}))},setReadOnly:function(t){this.editorOptions.readOnly=t,this.$refs.aceEditor.editor.setOptions({readOnly:t})}},mounted:function(){this.setReadOnly(this.readOnly),this.initializeConnection()},watch:{readOnly:function(t){this.setReadOnly(t)}}},y=b,k=(n("6a0e"),n("2877")),C=Object(k["a"])(y,f,p,!1,null,null,null),x=C.exports,q=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"preview"},[n("Markdown",{staticClass:"markdown-body",attrs:{content:t.content,options:t.options}})],1)},O=[],I=n("48cd"),S=n.n(I),L=n("1487"),_=n.n(L),E=function(t,e){if(e&&_.a.getLanguage(e))try{return _.a.highlight(e,t).value}catch(n){console.error(n)}try{return _.a.highlightAuto(t).value}catch(n){console.error(n)}return""},M={name:"Preview",components:{Markdown:S.a},props:{content:{type:String}},data:function(){return{options:{markdownIt:{highlight:E,html:!0,linkify:!0,breaks:!0},linkAttributes:{attrs:{target:"_blank",rel:"noopener"}}}}}},A=M,P=(n("ad0c"),Object(k["a"])(A,q,O,!1,null,null,null)),D=P.exports,$={name:"PageDocument",mixins:[u["a"],d["a"]],components:{AvatarRow:m["a"],DocumentEditor:x,DocumentPreview:D},props:{docId:{type:String,required:!0}},data:function(){return{loading:!0,contents:""}},computed:{documentName:function(){return this.docId.split(":")[0]}},methods:{updatePreview:function(t){this.contents=t},saveLocally:function(){var t=this,e=this.$refs.docEditor.content;e?r.a.setItem(t.docId,e).then((function(){t.showMessage('Locally saved "'.concat(t.documentName,'!"'),"positive")})).catch((function(e){t.showMessage(),console.log(e)})):t.showMessage('Locally saved "'.concat(t.documentName,'!"'),"positive")},restoreFromLocal:function(){var t=this,e=t.$refs.docEditor;t.$q.dialog({title:"Confirm",message:"Are you sure you want to recover this document from local storage? This will overwrite the current document (if you have saved before).",cancel:!0}).onOk((function(){r.a.getItem(t.docId).then((function(n){n?(e.content=n,t.showMessage("Contents recovered!","positive")):t.showMessage("Nothing to restore")})).catch((function(e){t.showMessage(),console.log(e)}))}))},saveMarkdown:function(){var t=this.contents,e=this.documentName+".md",n=new Blob([t],{type:"text/plain;charset=utf-8"});c.a.saveAs(n,e)},savePdf:function(){window.print()}},mounted:function(){}},Q=$,U=(n("df27"),n("4d5a")),N=n("e359"),R=n("65c6"),j=n("9c40"),z=n("6ac5"),F=n("4e73"),T=n("1c1c"),V=n("66e5"),B=n("4074"),W=n("eb85"),G=n("09e3"),H=n("9989"),K=n("74f7"),J=n("0d59"),Y=n("7f67"),X=n("eebe"),Z=n.n(X),tt=Object(k["a"])(Q,o,a,!1,null,null,null);e["default"]=tt.exports;Z()(tt,"components",{QLayout:U["a"],QHeader:N["a"],QToolbar:R["a"],QBtn:j["a"],QToolbarTitle:z["a"],QMenu:F["a"],QList:T["a"],QItem:V["a"],QItemSection:B["a"],QSeparator:W["a"],QPageContainer:G["a"],QPage:H["a"],QInnerLoading:K["a"],QSpinner:J["a"]}),Z()(tt,"directives",{ClosePopup:Y["a"]})},cc8f:function(t,e,n){"use strict";n.d(e,"b",(function(){return o}));var o={methods:{showMessage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Uh oh, something went wrong",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"negative",n=this.$q.screen.gt.xs?"top":"bottom";this.$q.notify({message:t,color:e,position:n,timeout:2e3,actions:[{label:"",icon:"close",color:"white",dense:!0,handler:function(){}}]})}}};e["a"]=o},df27:function(t,e,n){"use strict";n("2960")},ecf6:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.isOffline?n("div",{staticClass:"text-weight-bold text-grey-5"},[t._v("\n    You're offline\n  ")]):n("div",{staticClass:"avatar-row q-mr-sm"},[n("v-animal",{key:t.uid,staticClass:"current-user",attrs:{name:t.currentUserAnimal,color:t.currentUserColor,dance:"",size:"40px"}}),t._l(t.userObjects,(function(t){return n("v-animal",{key:t.key,attrs:{name:t.name,color:t.color,size:"40px"}})})),t.remainingUsers>0?n("div",{staticClass:"user-overflow"},[t._v("\n      +"+t._s(t.remainingUsers)+"\n    ")]):t._e()],2)])},a=[],i=(n("4de4"),n("d81d"),n("fb6a"),n("ac1f"),n("1276"),n("3b6c")),r=n.n(i),s=n("f430"),c=7,l={name:"AvatarRow",mixins:[s["a"]],components:{"v-animal":r.a},computed:{cappedList:function(){var t=this,e=this.users.filter((function(e){return e.key!==t.uid+":"+t.timestamp}));return e.slice(0,c)},userObjects:function(){return this.cappedList.map((function(t){var e=t.uid.split(" ");return{key:t.key,color:e[0],name:e[1]}}))},remainingUsers:function(){return this.users.length-c},currentUserColor:function(){return this.uid.split(" ")[0]},currentUserAnimal:function(){return this.uid.split(" ")[1]}},methods:{isCurrentUser:function(t){return this.uid===t}}},d=l,u=(n("8fb8"),n("2877")),m=Object(u["a"])(d,o,a,!1,null,null,null);e["a"]=m.exports},f430:function(t,e,n){"use strict";var o=n("ded3"),a=n.n(o),i=n("2f62"),r={computed:a()({},Object(i["c"])("store",["uid","users","timestamp","isOffline","readOnly"])),methods:a()({},Object(i["b"])("store",["setUser","addUser","removeUser","setTimestamp","setIsOffline","setReadOnly"]))};e["a"]=r}}]);